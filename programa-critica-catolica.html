<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Crítica Católica – Valmi TV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <header>
    <div class="container navbar">
      <div class="brand">
        <div class="brand-logo"></div>
        <div class="brand-title">VALMI TV</div>
      </div>
      <div class="nav-toggle" onclick="toggleMenu()">
        <span></span><span></span><span></span>
      </div>
      <nav class="nav-menu" id="navMenu">
        <ul>
          <li><a href="index.html">Início</a></li>
          <li><a href="programas.html">Programas</a></li>
          <li><a href="ao-vivo.html">Ao vivo</a></li>
          <li><a href="podcast.html">Podcast</a></li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="contato.html">Contato</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="page-header">
      <h1 class="page-title">Crítica Católica</h1>
      <p class="page-description">
        Um programa de análise e comentário de acontecimentos, ideias e
        movimentos à luz da fé católica.
      </p>
    </section>

    <section class="section program-layout">
      <div>

        <!-- ===========================
             VÍDEO PRINCIPAL AUTOMÁTICO
        ============================ -->
        <div class="program-hero">
          <h2 class="section-title">Último episódio</h2>

          <div class="card-thumb" id="mainVideo" style="margin-bottom:1rem; overflow:hidden;">
            <!-- Vídeo aparece aqui -->
          </div>

          <div class="program-meta">
            Reprodução automática a partir da playlist oficial.
          </div>

          <div class="hero-actions" style="margin-top:1rem;">
            <a href="https://www.youtube.com/playlist?list=PLrOEqj4ng7UJeLkyVzpXm2jMYz6qySQc9" target="_blank" class="btn btn-primary">
              Ver playlist completa
            </a>
          </div>
        </div>

        <!-- ===========================
             EPISÓDIOS RECENTES
        ============================ -->
        <div class="program-episodes">
          <h2 class="section-title">Episódios recentes</h2>
          <div id="recentEpisodes"></div>
        </div>

      </div>

      <aside class="sidebar-card">
        <h3 class="card-title">Outros programas Valderi</h3>
        <ul style="list-style:none; margin-top:0.5rem; font-size:0.9rem;">
          <li><a href="#" style="color:#f5f5f5; text-decoration:none;">.filos</a></li>
          <li><a href="#" style="color:#f5f5f5; text-decoration:none;">O Católico</a></li>
          <li><a href="programas-valderi.html" style="color:#f5f5f5; text-decoration:none;">Ver todos</a></li>
        </ul>
      </aside>
    </section>
  </main>

  <footer>
    <div class="container">
      <div>© <span id="year"></span> Valmi TV.</div>
    </div>
  </footer>

  <script>
    function toggleMenu() {
      const menu = document.getElementById('navMenu');
      menu.classList.toggle('open');
    }
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===============================
    //   CONFIGURAÇÕES
    // ===============================
    const API_KEY = "AIzaSyAmNoCTSSD4t7YJCzo_Ak_BYXDmvFrM0cE";
    const PLAYLIST_ID = "PLrOEqj4ng7UJeLkyVzpXm2jMYz6qySQc9";
    const MAX_RESULTS = 3;

    const mainVideoDiv = document.getElementById("mainVideo");
    const recentContainer = document.getElementById("recentEpisodes");

    // ===============================
    //   BUSCAR VÍDEOS DA PLAYLIST
    // ===============================
    async function loadPlaylist() {
      const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=${MAX_RESULTS}&playlistId=${PLAYLIST_ID}&key=${API_KEY}`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        if (!data.items) return;

        // --- VÍDEO PRINCIPAL (primeiro item)
        const first = data.items[0].snippet;
        const firstId = first.resourceId.videoId;

        mainVideoDiv.innerHTML = `
          <iframe style="width:100%; aspect-ratio:16/9; border:0;"
            src="https://www.youtube.com/embed/${firstId}"
            allowfullscreen>
          </iframe>
        `;

        // --- EPISÓDIOS RECENTES ---
        recentContainer.innerHTML = data.items
          .map(item => {
            const s = item.snippet;
            const vid = s.resourceId.videoId;

            return `
              <article class="episode-item">
                <div class="episode-thumb" style="
                  background:url('https://i.ytimg.com/vi/${vid}/hqdefault.jpg');
                  background-size:cover;">
                </div>

                <div>
                  <h3 class="card-title">${s.title}</h3>
                  <div class="card-meta">
                    ${new Date(s.publishedAt).toLocaleDateString("pt-BR")}
                  </div>

                  <p style="font-size:0.9rem; margin-top:0.25rem;">
                    ${s.description.substring(0, 140)}...
                  </p>

                  <a href="https://www.youtube.com/watch?v=${vid}" target="_blank"
                    class="btn btn-secondary" style="margin-top:0.4rem;">
                    Assistir
                  </a>
                </div>
              </article>
            `;
          })
          .join("");

      } catch (error) {
        console.error("Erro ao carregar playlist:", error);
      }
    }

    loadPlaylist();
  </script>

</body>
</html>
